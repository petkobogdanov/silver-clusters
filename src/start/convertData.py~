import csv
import os
from util import printSeparator

def generateCSV(infile, outfile, bright=False):
    "Convert the raw CSV file to our csv format"        
    printSeparator()
    outfile = outfile + ".csv"
    try:
        os.remove(outfile)
    except OSError:
        pass
    print "Running generateCSV\n" + "infile: " + infile + "\n" +  "outfile: " + outfile
    with open(infile, 'rb') as inCSV, open(outfile, 'wb') as outCSV:
        csvReader = csv.reader(inCSV)
        outCSV.write(",".join(csvReader.next()[1:6]) + "\n")
        for line in csvReader:
            try:
                if bright is True and (int(line[6]) == 1):
                    # print line[6]
                    outCSV.write(",".join(line[1:6]) + "\n")
                if bright is False and (int(line[6]) == 0):
                    # print line[6]
                    outCSV.write(",".join(line[1:6]) + "\n")
            except ValueError:
                continue    
    printSeparator(True)

def generateFasta(infile, outfile, bright=False):
    "Convert the raw CSV file to fasta format"
    printSeparator()    
    outfile = outfile + ".fa"    
    try:
        os.remove(outfile)
    except OSError:
        pass
    print "Running generateFasta\n" + "infile: " + infile + "\n" +  "outflie: " + outfile
    with open(infile, 'rb') as inCSV, open(outfile, 'wb') as outFasta:
        csvReader = csv.reader(inCSV)
        csvReader.next()
        for line in csvReader:
            try:
                if bright is True and (int(line[6]) == 1):                    
                    outFasta.write(">" + line[1] + "\n" + line[2] + "\n")
                if bright is False and (int(line[6]) == 0):
                    outFasta.write(">" + line[1] + "\n" + line[2] + "\n")
            except ValueError:
                continue            
    printSeparator(True)
